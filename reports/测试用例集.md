# 测试用例集

## 测试框架
- `vitest`（单元测试），`jsdom`（DOM 模拟）

## 用例列表
- after_render 过滤器
  - 注入资源：在 `</head>` 插入 `preconnect/dns-prefetch`，在 `</body>` 插入补丁脚本。
  - 图片优化：为所有 `<img>` 注入 `loading="lazy"` 与 `decoding="async"`（保留既有属性）。
  - 幂等：重复处理不重复注入（通过字符串包含判断）。
- 前端补丁（运行时）
  - 输入框焦点：为 `input/textarea` 绑定 `focus/blur`，排除 `#center-console/#page-type`。
  - 入焦时 `anzhiyu_intype` 为 `true`，失焦为 `false`。

## 命令
- 单元测试：`npm run test`
- 性能采集：
  - 基线：`BLOG_PATCHES_DISABLE=1 npx hexo server` + `npx lhci collect` + `npx lhci upload`
  - 优化后：`npm run server` + `npx lhci collect` + `npx lhci upload`

## 测试结果
- 单元测试全部通过；
- Lighthouse 报告已生成至 `reports/lhci/`，用于对比分析。